@using Microsoft.AspNetCore.Http
@inject Microsoft.AspNetCore.Http.IHttpContextAccessor HttpContextAccessor
@model EmployeeApplication.Models.Employee

@{
    ViewData["Title"] = "Details";
}

@*<h2>Details</h2>*@

<h4>fiche Employee</h4>
<hr />
@*<dl class="dl-horizontal">
          <dt>   @Html.DisplayNameFor(model => model.Cin)  </dt> <dd>   @Html.DisplayFor(model => model.Cin)
      </dd> <dt>  @Html.DisplayNameFor(model => model.Nom)  </dt> <dd>   @Html.DisplayFor(model => model.Nom) </dd> <dt>  @Html.DisplayNameFor(model => model.Prenom) </dt> <dd>
      @Html.DisplayFor(model => model.Prenom) </dd> <dt>   @Html.DisplayNameFor(model => model.DateNaissance)  </dt>  <dd>
     @Html.DisplayFor(model => model.DateNaissance)    </dd>    <dt>  @Html.DisplayNameFor(model => model.Email)  </dt> <dd>
     @Html.DisplayFor(model => model.Email) </dd> <dt>     @Html.DisplayNameFor(model => model.Telephone)  </dt>  <dd>
    @Html.DisplayFor(model => model.Telephone)  </dd>  <dt>      @Html.DisplayNameFor(model => model.Adresse)  </dt>  <dd>      @Html.DisplayFor(model => model.Adresse)  </dd>
              <dt>  @Html.DisplayNameFor(model => model.Sexe) </dt><dd>     @Html.DisplayFor(model => model.Sexe) </dd> <dt>   @Html.DisplayNameFor(model => model.DateEmbauché) </dt>  <dd>   @Html.DisplayFor(model => model.DateEmbauché)  </dd> <dt>@Html.DisplayNameFor(model => model.SoldeCongé)   </dt> <dd>   @Html.DisplayFor(model => model.SoldeCongé)  </dd></dl>*@
@{var photoPath = "http://localhost:52779/images/" +Model.Image?? "7c155925-773a-4ef4-bbf2-e28e1e84df5a_téléchargement.png";

    var Role = @HttpContextAccessor.HttpContext.Session.GetString("Email");
}

@*<div class="row clearfix">
        <div class="col-lg-4 col-md-12">
            <div class="card">
                <div class="m-b-20">
                    <div class="contact-grid">
                        <div class="profile-header bg-dark">
                            <dl class="dl-horizontal">
                                <dt>
                                    @Html.DisplayNameFor(model => model.Cin)
                                </dt>
                                <dd>
                                    @Html.DisplayFor(model => model.Cin)
                                </dd>
                            </dl>
                        </div>
                        </div>
                        <div class="dropdown-toggle" data-bs-toggle="dropdown">
                            <img src="@photoPath" width="50" height="80">
                        </div>
                        <ul class="dropdown-menu pullDown">
                           <li class="body">
                                <ul class="user_dw_menu">
                                    <li>
                                        <a asp-controller="Employee" asp-action="Details" asp-route-id="@HttpContextAccessor.HttpContext.Session.GetString("EmployeeID")">
                                        </a>
                                    </li>
                                </ul>
    </li>
                        </ul>

                    </div>

                    <p>
                        <dl class="dl-horizontal">
                            <dt>
                                @Html.DisplayNameFor(model => model.Email)
                            </dt>
                            <dd>
                                @Html.DisplayFor(model => model.Email)
                            </dd>

                        </dl>
                    </p>
                    <div>
                        <span class="phone">
                            <i class="material-icons"></i>
                        <p>
                            <dl class="dl-horizontal">
                                <dt>
                                    @Html.DisplayNameFor(model => model.Telephone)
                                </dt>
                                <dd>
                                    @Html.DisplayFor(model => model.Telephone)
                                </dd>
                            </dl>
                        </p>
                        </span>
                    </div>

                </div>
            </div>
            </div>*@

<div class="row clearfix">
    <div class="col-lg-4 col-md-12">
        <div class="card">
            <div class="m-b-20">
                <div class="contact-grid">
                    <div class="profile-header bg-dark">
                        <br />
                        <dl class="dl-horizontal">
                            <dt>
                                @Html.DisplayNameFor(model => model.Cin)
                            </dt>
                            <dd>
                                @Html.DisplayFor(model => model.Cin)
                            </dd>
                        </dl>
                    </div>
                    @*@HttpContextAccessor.HttpContext.Session.GetString("Email")*@
                    <img src="@photoPath" asp-append-version="true" class="user-img" alt="">
                    
                    @*<img src="@photoPath" asp-append-version="true" alt="test">*@
                    @*<div class="profile-usertitle">
            <div class="sidebar-userpic-name"> @HttpContextAccessor.HttpContext.Session.GetString("Email") </div>
            <div class="profile-usertitle-job ">  </div>
        </div>*@
                    @*<img src="../../assets/images/user/usrbig3.jpg" class="user-img" alt="" width="50" height="80">*@
                    <p>
                        <dl class="dl-horizontal">
                            <dt>
                                @Html.DisplayNameFor(model => model.Email)
                            </dt>
                            <dd>
                                @Html.DisplayFor(model => model.Email)
                            </dd>

                        </dl>
                    </p>
                    <div>
                        <span class="phone">
                            <i class="material-icons"></i>
                            <p>
                                <dl class="dl-horizontal">
                                    <dt>
                                        @Html.DisplayNameFor(model => model.Telephone)
                                    </dt>
                                    <dd>
                                        @Html.DisplayFor(model => model.Telephone)
                                    </dd>
                                </dl>
                            </p>
                        </span>
                    </div>

                </div>
            </div>
        </div>
    </div>
    <div class="col-lg-8 col-md-12">
        <div class="card">
            <div class="profile-tab-box">
                <div class="p-l-20">
                    <ul class="nav ">
                        <li class="nav-item tab-all">
                            <a class="nav-link active show" href="#project" data-bs-toggle="tab">
                                About
                                Me
                            </a>
                        </li>
                        <li class="nav-item tab-all p-l-20">
                            <a class="nav-link" href="#usersettings" data-bs-toggle="tab">Settings</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="tab-content">
            <div role="tabpanel" class="tab-pane active" id="project" aria-expanded="true">
                <div class="row clearfix">
                    <div class="col-lg-12 col-md-12 col-sm-12">
                        <div class="card project_widget">
                            <div class="header">
                                <h2>About</h2>
                            </div>
                            <div class="body">
                                <div class="row">
                                    <div class="col-md-3 col-6 b-r">
                                        @*<strong>Full Name</strong>*@
                                        <dl class="dl-horizontal">

                                            <dt>
                                                @Html.DisplayNameFor(model => model.Nom)
                                            </dt>
                                            <dd>
                                                @Html.DisplayFor(model => model.Nom)
                                            </dd>
                                            <dt>
                                                @Html.DisplayNameFor(model => model.Prenom)
                                            </dt>
                                            <dd>
                                                @Html.DisplayFor(model => model.Prenom)
                                            </dd>
                                            <dt>
                                                Solde Coungé
                                            </dt>
                                            <dd>
                                                @Html.DisplayFor(model => model.SoldeCongé)
                                            </dd>
                                        </dl>
                                        <br>
                                        @*<p class="text-muted">Emily Smith</p>*@
                                    </div>
                                    <div class="col-md-3 col-6 b-r">

                                        <dl class="dl-horizontal">

                                            <dt>
                                                @Html.DisplayNameFor(model => model.DateNaissance)
                                            </dt>
                                            <dd>
                                                @Html.DisplayFor(model => model.DateNaissance)
                                            </dd>
                                        </dl>
                                        @*<strong>Mobile</strong>*@
                                        <br>
                                        @*<p class="text-muted">(123) 456 7890</p>*@
                                    </div>
                                    <div class="col-md-3 col-6 b-r">
                                        <dl class="dl-horizontal">

                                            <dt>
                                                @Html.DisplayNameFor(model => model.Adresse)
                                            </dt>
                                            <dd>
                                                @Html.DisplayFor(model => model.Adresse)
                                            </dd>
                                        </dl>
                                        <br>
                                    </div>
                                    <div class="col-md-3 col-6">
                                        <dl class="dl-horizontal">
                                            <dt>
                                                @Html.DisplayNameFor(model => model.DateEmbauché)
                                            </dt>
                                            <dd>
                                                @Html.DisplayFor(model => model.DateEmbauché)
                                            </dd>
                                        </dl>
                                        <br>
                                    </div>
                                </div>
                                <p class="m-t-30">
                                    Completed my graduation in Arts
                                </p>
                              

                                <br>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
            <div role="tabpanel" class="tab-pane" id="timeline" aria-expanded="false">
            </div>
            <div role="tabpanel" class="tab-pane" id="usersettings" aria-expanded="false">
                <div class="card">
                    <div class="header">
                        <h2>
                            <strong>
                                Les paramètres de sécurité
                            </strong>
                        </h2>
                    </div>
                    <div id="alert" role="alert">
                        <p id="error"></p>
                    </div>
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                    <input type="hidden" id="IdEmp" asp-for="IdEmployee" />
                    <div class="body">

                        <div class="form-group">
                            <input type="password" id="Password" class="form-control" placeholder="nouveau mot de passe">
                        </div>
                        <div class="form-group">
                            <input type="password" id="confirmPassword" class="form-control" placeholder="Confirmer le nouveau mot de passe">
                        </div>
                        <button class="btn btn-info btn-round" onclick="changePassword()">Sauvegarder les modifications</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<div>
    <a asp-action="Edit" asp-route-id="@Model.IdEmployee">Modifier</a> |
    <a asp-action="Index">Retour à la liste</a>
</div>

<script src="https://code.jquery.com/jquery-1.9.1.min.js"></script>
<script>

    function changePassword() {

        var password = $('#Password').val();
        var id = $('#IdEmp').val();
        var confirmPassword = $('#confirmPassword').val();
        if (confirmPassword != password) {
            $('#alert').addClass("alert alert-danger");

            $('#error').text("Mot de passe différente");
        }
        else {
            var data = {

                IdEmployee: id,
                NewPassword: password

            }
            $.ajax({
                type: "POST",
                url: '/Employee/EditPassword',
                data: data,
                success: function (data) {
                    $('#alert').addClass("alert alert-success");
                    $('#error').text("Mot de passe change");

                },
                error: function () {
                    alert('Failed');
                }
            });
        }
    }


</script>
